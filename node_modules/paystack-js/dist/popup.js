var Popup=function(){"use strict";function n(){for(var n="",e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=0;5>t;t+=1)n+=e.charAt(Math.floor(62*Math.random()));return n}function e(n,e){var t,a,i,r={email:"email",amount:"integer",transaction_charge:"integer",invoice_limit:"integer",onClose:"function",callback:"function",metadata:"object",channels:"array"};function o(n){throw Error("Attribute "+n+" must be a valid "+r[n])}if(r[n]&&e)switch(r[n]){case"email":/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e)||o(n);break;case"integer":(parseInt(i=e,10)!==i||0>i)&&o(n);break;case"function":(a=e)&&a&&"[object Function]"==={}.toString.call(a)||o(n);break;case"object":((t=e)!==Object(t)||"[object Array]"===Object.prototype.toString.call(t))&&o(n);break;case"array":(function(n){return n.constructor===Array})(e)||o(n)}}var t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},a=function(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")},i=function(){function n(n,e){for(var t=0;e.length>t;t++){var a=e[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(n,a.key,a)}}return function(e,t,a){return t&&n(e.prototype,t),a&&n(e,a),e}}(),r=Object.assign||function(n){for(var e=1;arguments.length>e;e++){var t=arguments[e];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(n[a]=t[a])}return n};var o="undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{};function s(n,e){this.fun=n,this.array=e}s.prototype.run=function(){this.fun.apply(null,this.array)};var c={cookieTestUrl:"https://crayon.paystack.co/test-iframe/start.html",publishableKey:"uFmz/uE/SDT6GupOrSEXIZXGByjQ0zFkPyc9LqKHFqnTI0WPN3JS5kQPo/j9or0TOXlqMQj2lzHn/UGsQT4XeQ==",publicKey:"-----BEGIN PUBLIC KEY-----\r\nMFwwDQYJKoZIhvcNAQEBBQADSwAwSAJBALhZs/7hP0g0+hrqTq0hFyGVxgco0NMx\r\nZD8nPS6ihxap0yNFjzdyUuZED6P4/aK9Ezl5ajEI9pcx5/1BrEE+F3kCAwEAAQ==\r\n-----END PUBLIC KEY-----"},l=(r({},c,{checkoutUrl:"http://localhost:8080/",paymentBaseUrl:"https://crayon.paystack.co/",paystackApiUrl:"https://studio-api.paystack.co/",pusherKey:"1c7b262ee18455815893",pusherUrl:"https://checkout-studio.paystack.com/static/vendor/pusher.min.js"}),r({},c,{checkoutUrl:"https://checkout-studio.paystack.com/",paymentBaseUrl:"https://crayon.paystack.co/",paystackApiUrl:"https://studio-api.paystack.co/",pusherKey:"1c7b262ee18455815893",pusherUrl:"https://checkout-studio.paystack.com/static/vendor/pusher.min.js"}),r({},c,{checkoutUrl:"https://checkout.paystack.com/",paymentBaseUrl:"https://standard.paystack.co/",paystackApiUrl:"https://api.paystack.co/",pusherKey:"8e4b9b7ca3418bd5cdc8",pusherUrl:"https://checkout.paystack.com/static/vendor/pusher.min.js"}));return window,function(){function r(n){a(this,r),this.defaults=function(n){if(void 0===n.key)throw Error("Please provide your public key via the key attribute");if(void 0===n.amount&&void 0===n.plan)throw Error("Please provide transaction amount via the amount or plan attribute");if(void 0===n.email&&void 0===n.customer_code)throw Error("Please provide customer email via the email or customerCode attribute");if(n.transaction_charge&&n.transaction_charge>=n.amount)throw Error("Transaction charge must be less than the transaction amount");if(n.bearer&&"account"!==n.bearer&&"subaccount"!==n.bearer)throw Error("Bearer should be either account or subaccount");if(n.channels&&!n.channels.length)throw Error("Channels should be an array of [card, bank] values");return Object.keys(n).forEach(function(t){e(t,n[t])}),n}({key:n.key||"",ref:n.ref||"",label:n.label||"",email:n.email||"",amount:n.amount||"",currency:n.currency||"NGN",firstname:n.firstname||n.firstName||"",lastname:n.lastname||n.lastName||"",phone:n.phone||"",remark:n.remark||"",payment_page:n.payment_page||n.paymentPage||"",payment_request:n.payment_request||n.paymentRequest||"",plan:n.plan||"",quantity:n.quantity||"",coupon:n.coupon||"",customer_code:n.customer_code||n.customerCode||"",invoice_limit:n.invoice_limit||n.invoiceLimit||"",start_date:n.start_date||n.startDate||"",interval:n.interval||n.interval||"",subaccount:n.subaccount||"",transaction_charge:n.transaction_charge||n.transactionCharge||"",bearer:n.bearer||"",metadata:n.metadata||"",onClose:n.onClose||"",callback:n.callback||"",tlsFallback:n.tlsFallback||"",channels:n.channels||"",hash:n.hash||""}),this.isIframeOpen=!1,this.eventListener=this.eventListener.bind(this),this.setupBackground(),this.setupIframe(),this.listenForEvents()}return i(r,[{key:"setupBackground",value:function(){var e=document.createElement("iframe");e.setAttribute("frameBorder","0"),e.setAttribute("allowtransparency","true"),e.id=n(),e.name="paystack-checkout-background-"+e.id,e.style.cssText="\n  z-index: 999999999999999;\n  background: transparent;\n  background: rgba(0, 0, 0, 0.75);    \n  border: 0px none transparent;\n  overflow-x: hidden;\n  overflow-y: hidden;\n  margin: 0;\n  padding: 0;\n  -webkit-tap-highlight-color: transparent;\n  -webkit-touch-callout: none;\n  position: fixed;\n  left: 0;\n  top: 0;\n  width: 100%;\n  height: 100%;\n  transition: opacity 0.3s;\n  -webkit-transition: opacity 0.3s;\n  visibility: hidden;\n",e.style.display="none",this.background=e,document.body.appendChild(e);var t=this.background.contentWindow.document;t.open(),t.write('\n  <!DOCTYPE html>\n  <html lang="en">\n\n  <head>\n    <meta charset="UTF-8">\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\n    <meta http-equiv="X-UA-Compatible" content="ie=edge">\n    <title>Paystack Popup Loader</title>\n    <style>\n      .app-loader {\n        margin: 200px 0;\n        text-align: center;\n        color: white;\n      }      \n      @keyframes app-loader__spinner {\n        0% {\n          opacity: 1;\n        }\n        100% {\n          opacity: 0;\n        }\n      }\n      @-webkit-keyframes app-loader__spinner {\n        0% {\n          opacity: 1;\n        }\n        100% {\n          opacity: 0;\n        }\n      }\n      .app-loader__spinner {\n        position: relative;\n        display: inline-block;\n      }\n      .app-loader__spinner div {\n        left: 95px;\n        top: 35px;\n        position: absolute;\n        -webkit-animation: app-loader__spinner linear 1s infinite;\n        animation: app-loader__spinner linear 1s infinite;\n        background: white;\n        width: 10px;\n        height: 30px;\n        border-radius: 40%;\n        -webkit-transform-origin: 5px 65px;\n        transform-origin: 5px 65px;\n      }\n      .app-loader__spinner div:nth-child(1) {\n        -webkit-transform: rotate(0deg);\n        transform: rotate(0deg);\n        -webkit-animation-delay: -0.916666666666667s;\n        animation-delay: -0.916666666666667s;\n      }\n      .app-loader__spinner div:nth-child(2) {\n        -webkit-transform: rotate(30deg);\n        transform: rotate(30deg);\n        -webkit-animation-delay: -0.833333333333333s;\n        animation-delay: -0.833333333333333s;\n      }\n      .app-loader__spinner div:nth-child(3) {\n        -webkit-transform: rotate(60deg);\n        transform: rotate(60deg);\n        -webkit-animation-delay: -0.75s;\n        animation-delay: -0.75s;\n      }\n      .app-loader__spinner div:nth-child(4) {\n        -webkit-transform: rotate(90deg);\n        transform: rotate(90deg);\n        -webkit-animation-delay: -0.666666666666667s;\n        animation-delay: -0.666666666666667s;\n      }\n      .app-loader__spinner div:nth-child(5) {\n        -webkit-transform: rotate(120deg);\n        transform: rotate(120deg);\n        -webkit-animation-delay: -0.583333333333333s;\n        animation-delay: -0.583333333333333s;\n      }\n      .app-loader__spinner div:nth-child(6) {\n        -webkit-transform: rotate(150deg);\n        transform: rotate(150deg);\n        -webkit-animation-delay: -0.5s;\n        animation-delay: -0.5s;\n      }\n      .app-loader__spinner div:nth-child(7) {\n        -webkit-transform: rotate(180deg);\n        transform: rotate(180deg);\n        -webkit-animation-delay: -0.416666666666667s;\n        animation-delay: -0.416666666666667s;\n      }\n      .app-loader__spinner div:nth-child(8) {\n        -webkit-transform: rotate(210deg);\n        transform: rotate(210deg);\n        -webkit-animation-delay: -0.333333333333333s;\n        animation-delay: -0.333333333333333s;\n      }\n      .app-loader__spinner div:nth-child(9) {\n        -webkit-transform: rotate(240deg);\n        transform: rotate(240deg);\n        -webkit-animation-delay: -0.25s;\n        animation-delay: -0.25s;\n      }\n      .app-loader__spinner div:nth-child(10) {\n        -webkit-transform: rotate(270deg);\n        transform: rotate(270deg);\n        -webkit-animation-delay: -0.166666666666667s;\n        animation-delay: -0.166666666666667s;\n      }\n      .app-loader__spinner div:nth-child(11) {\n        -webkit-transform: rotate(300deg);\n        transform: rotate(300deg);\n        -webkit-animation-delay: -0.083333333333333s;\n        animation-delay: -0.083333333333333s;\n      }\n      .app-loader__spinner div:nth-child(12) {\n        -webkit-transform: rotate(330deg);\n        transform: rotate(330deg);\n        -webkit-animation-delay: 0s;\n        animation-delay: 0s;\n      }\n      .app-loader__spinner {\n        width: 40px;\n        height: 40px;\n        -webkit-transform: translate(-20px, -20px) scale(0.2) translate(20px, 20px);\n        transform: translate(-20px, -20px) scale(0.2) translate(20px, 20px);\n      }\n    </style>\n  </head>\n\n  <body>\n    <div id="app-loader" class="app-loader">\n      <div id="spinner" class="app-loader__spinner">\n        <div></div><div></div><div></div><div></div><div></div><div></div><div>\n        </div><div></div><div></div><div></div><div></div><div></div>\n      </div>\n    </div>\n  </body>\n\n  </html>\n'),t.close()}},{key:"setupIframe",value:function(){var e=document.createElement("iframe");e.setAttribute("frameBorder","0"),e.setAttribute("allowtransparency","true"),e.id=n(),e.name="paystack-checkout-"+e.id,e.style.cssText="\n  z-index: 999999999999999;\n  background: transparent;\n  border: 0px none transparent;\n  overflow-x: hidden;\n  overflow-y: hidden;\n  margin: 0;\n  padding: 0;\n  -webkit-tap-highlight-color: transparent;\n  -webkit-touch-callout: none;\n  position: fixed;\n  left: 0;\n  top: 0;\n  width: 100%;\n  visibility: hidden;\n  height: 100%;\n",e.style.display="none",e.src=this.getUrl(),this.iframe=e,document.body.appendChild(e)}},{key:"getUrl",value:function(){var n=this.defaults,e={};Object.keys(n).filter(function(e){return""!==n[e]}).forEach(function(t){e[t]=n[t]}),e.metadata&&"string"!=typeof e.metadata&&(e.metadata=JSON.stringify(e.metadata)),delete e.callback,delete e.onClose;var a=function n(e,a){var i=[];return Object.keys(e).forEach(function(r){var o=a?a+"["+r+"]":r,s=e[o];i.push(null!==s&&"object"===("undefined"==typeof v?"undefined":t(v))?n(s,o):encodeURIComponent(r)+"="+encodeURIComponent(s))}),i.join("&")}(e);return l.checkoutUrl+"popup?params="+a}},{key:"open",value:function(){this.iframe&&!this.isIframeOpen&&(this.background.style.display="",this.background.style.visibility="visible",this.iframe.style.display="",this.iframe.contentWindow.postMessage("render","*"),this.isIframeOpen=!0)}},{key:"removeLoader",value:function(){this.iframe.style.visibility="visible",this.background.contentWindow.document.getElementById("app-loader").style.display="none"}},{key:"close",value:function(){var n=this;return this.background.style.opacity=0,this.iframe.style.display="none",this.iframe.contentWindow.postMessage("close","*"),this.isIframeOpen=!1,new Promise(function(e){setTimeout(function(){n.background.style.display="none",n.background.style.opacity=1,e()},300)})}},{key:"remove",value:function(){this.iframe.parentElement.removeChild(this.iframe),this.background.parentElement.removeChild(this.background),this.iframe=null,this.background=null,this.stopListeningForEvents()}},{key:"eventListener",value:function(n){var e=this;if(n.origin+"/"===l.checkoutUrl){var a=n.data||n.message;if("loaded"===a&&(this.removeLoader(),this.isIframeOpen&&this.iframe.contentWindow.postMessage("render","*")),"close"===a){if(this.close(),!this.defaults.onClose)return;this.defaults.onClose.call(this)}try{var i=JSON.parse(a);i&&"object"===(void 0===i?"undefined":t(i))&&"success"===i.status&&this.close().then(function(){e.postSuccess(i),e.remove()})}catch(n){}}}},{key:"postSuccess",value:function(n){this.defaults.callback&&this.defaults.callback.call(this,n)}},{key:"listenForEvents",value:function(){window.addEventListener("message",this.eventListener)}},{key:"stopListeningForEvents",value:function(){window.removeEventListener("message",this.eventListener,!1)}}]),r}()}();
